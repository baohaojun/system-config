#!/bin/bash
set -e

files=$(
    git diff HEAD --name-only
     )

target_commit=$(select-output-line -p "Which commit do you want to amend?" git log --pretty='%h %s' "$files" $(git-remote-branch)..HEAD | pn 1)
git commit --fixup=$target_commit -a
git rebase --no-ff -i --autosquash $target_commit^
