#+title: æ™ºèƒ½è¡¥é½
# bhj-tags: bash

æ˜¨å¤©è¯´å®Œ[[../30/0-intelligent-cd.org][æ™ºèƒ½cd]]ï¼Œä»Šå¤©æ¥è¯´è¯´Bashä¸‹çš„æ™ºèƒ½è¡¥é½ã€‚è·ŸEmacs[fn:skeleton]ä¸‹çš„Anything.el /
Helm.elä¸€æ ·ï¼Œæˆ‘ä»¬çš„è¡¥é½åº”è¯¥å¯ä»¥éšæ„æ‰“å‡ ä¸ªè¯å¹²ï¼Œç„¶åå°±æŠŠæ•´æ¡å‘½ä»¤è¡¥å‡ºæ¥ã€‚

ä¸Bashè‡ªå¸¦çš„Ctrl-R / Ctrl-Så†å²å‘½ä»¤æœç´¢ç›¸æ¯”ï¼Œå®ƒä»¬å¼€å§‹åŒ¹é…ä¹‹åï¼Œè¦æ±‚å¿…é¡»
æ˜¯è¿ç»­åœ°ä¸€ç›´åŒ¹é…ä¸‹å»ï¼Œä¸­é—´ä¸èƒ½æ–­ï¼Œè¿™å¯¹ç”¨æˆ·æ¥è¯´æœ‰ç‚¹ä¸å¤Ÿå‹å¥½ã€‚è€Œæˆ‘çš„è¡¥é½
æ–¹å¼ä¹‹ä¸‹ï¼Œç”¨æˆ·å¯ä»¥æçº²å¥‘é¢†çš„è¾“å…¥å‡ ä¸ªä¿¡æ¯é‡é«˜çš„è¯å¹²ï¼Œä»è€Œä¿è¯ä¸€æ—¦è¡¥é½ä¹‹
åï¼Œä¼šæ˜¯å”¯ä¸€è¡¥é½ï¼Œä¸éœ€è¦è¿›è¡Œå¤šé¡¹é€‰æ‹©ï¼›å³ä½¿è¢«è¿«éœ€è¦å¤šé€‰ï¼Œä¹Ÿå¯ä»¥åšå¾—æ¯”
Bashè‡ªå¸¦çš„æ›´æ–¹ä¾¿ï¼

åšæ³•æ˜¯è¿™æ ·ï¼Œæˆ‘å†™äº†ä¸€ä¸ªç©ºBashå‡½æ•°ï¼Œåä¸ºreï¼ŒRe-Execï¼ˆå†æ¬¡æ‰§è¡Œï¼‰çš„æ„æ€ï¼Œå®ƒ
è‡ªå·±ä»€ä¹ˆä¹Ÿä¸å¹²ï¼Œï¼ˆé™¤äº†æŠŠå‚æ•°å…¨ä¸¢æ‰â€”â€”å®ƒçš„å®šä¹‰æ˜¯ =re () { true; }= ï¼‰ï¼Œä½†
æˆ‘ä¸ºå®ƒå†™äº†Bashè¡¥é½å‘½ä»¤æ‰æ˜¯çªé—¨ğŸ˜Š

#+NAME: ~/system-config/.bash_completion.d/re
#+BEGIN_SRC sh
#!/bin/bash

function _re()
{
    local cur prev
    local IFS=$'\n'

    COMPREPLY=()
    set -- "${COMP_WORDS[@]}"
    shift
    

    COMPREPLY=( $(skeleton_compgen_word.pl \
        -d '\n' -p \; -f ~/.bash_history.bak \
        -- "$@")
    )
    return 0
}

complete -o default -F _re re rex
#+END_SRC

è¿™æ®µè¡¥é½é…ç½®çš„æ„æ€æ˜¯è¯´ï¼Œè®© =skeleton_compgen_word.pl= è¿™ä¸ªè„šæœ¬æ‹¿ç€reå‘½ä»¤æ‰€
å¸¦çš„å‚æ•°ä»¥æ¢è¡Œç¬¦ä¸ºåˆ†å‰²ç¬¦(-d '\n'ï¼‰ï¼Œå» =~/.bash_history.bak= é‡Œæ‰¾åŒ¹é…ï¼Œ
æ‰¾åˆ°ä»¥åå…ˆæ‰“ä¸ªåˆ†å·ï¼ˆ-p \;ï¼‰ï¼Œå†æŠŠè¿™ä¸ªåŒ¹é…è¡Œæ‰“å‡ºæ¥ã€‚

ä»¥æˆ‘æƒ³é‡æ–°ç¼–è¯‘ä¸€ä¸‹Androidé‡Œæˆ‘å¸è‡ªåŠ çš„ubootä¸ºä¾‹ï¼Œæˆ‘åªè®°å¾—ç¼–è¯‘çš„å‘½ä»¤æ˜¯mmï¼Œ
æ‰€ä»¥æˆ‘å°±è¾“å…¥ =re mm uboot .0= ç„¶åå°±æŒ‰Tabé”®ï¼ˆä¹Ÿå°±æ˜¯ä¸€èˆ¬shellä¸‹çš„è¡¥é½
é”®ï¼‰ï¼Œè¿™æ ·ä¸Šé¢çš„ =_re= å‡½æ•°å°±ä¼šè¢«æ‰§è¡Œã€‚

=skeleton_compgen_word.pl= è¿™ä¸ªè„šæœ¬æœ‰ä¸ªç‰¹ç‚¹ï¼Œå®ƒçœ‹åˆ°æœ€åä¸€ä¸ªå‚æ•°å¦‚æœæ˜¯ =.0
.1 .2= è¿™ç§æ ¼å¼çš„è¯ï¼Œå®ƒå°±ä¼šæŠŠç¬¬0ä¸ªã€ç¬¬1ä¸ªæˆ–ç¬¬2ä¸ªåŒ¹é…é¡¹æŠ½å‡ºæ¥æ‰“å°å‡ºå»ç„¶
åé©¬ä¸Šé€€å‡ºï¼ˆè€Œä¸æ˜¯é»˜è®¤çš„æŠŠæ‰€æœ‰åŒ¹é…é¡¹éƒ½æ‰“å‡ºå»ï¼‰ã€‚ç”±äºæˆ‘çš„å†å²å‘½ä»¤æ–‡ä»¶æ˜¯
åŠ¨æ€è°ƒæ•´çš„ï¼Œæœ€è¿‘ç”¨è¿‡çš„å†å²å‘½ä»¤ä¼šå‡ºç°åœ¨æœ€å‰é¢ï¼Œæ‰€ä»¥è¿™é‡Œè¡¥å‡ºæ¥çš„ç¬¬0ä¸ªåº”è¯¥
å°±æ˜¯æˆ‘æƒ³è¦çš„ï¼ˆå¦åˆ™æˆ‘å¯ä»¥æ‰“.1å»é€‰æ‹©ä¸‹ä¸€ä¸ªï¼Œç­‰ç­‰ï¼‰ã€‚

ä¸‹é¢å°±æ˜¯é­”æœ¯äº†ï¼šæˆ‘çš„ç¬¬ä¸€æ¡åŒ¹é…çš„å†å²å‘½ä»¤ï¼ˆåº”è¯¥è¯´æ˜¯ä¸€ä¸ªç»„åˆå‘½ä»¤ï¼‰æ˜¯
=(cd $(lookup-file vendor/marvell/generic/tcmd/kernel-helper); time mm
-j8 -k uboot)= ï¼Œç”±äºTabé”®æŒ‰ä¸‹æ—¶æœ€åä¸€ä¸ªå‚æ•°æ˜¯.0ï¼Œæ‰€ä»¥.0ä¼šè¢«è¡¥é½æˆè¿™æ¡
ï¼ˆè·Ÿå®ƒå®Œå…¨çœ‹ä¸å‡ºæœ‰ä»€ä¹ˆåŒ¹é…å…³ç³»çš„ï¼‰å†å²å‘½ä»¤ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ ä¼šçœ‹åˆ°è¾“å…¥ä» =re
mm uboot .0= å˜æˆäº†è¿™æ ·ï¼š

: re mm uboot (cd $(lookup-file vendor/marvell/generic/tcmd/kernel-helper); time mm -j8 -k uboot) 

ä½†æ˜¯ï¼Œäººç”Ÿæœ€æœ‰æ„æ€çš„å°±æ˜¯è¿™ä¸ªä½†æ˜¯ï¼çœ¼ç›äº®çš„ä½ è‚¯å®šå‘ç°äº†é—®é¢˜ï¼Œè¿™ä¸ªå†å²å‘½
ä»¤è¢«reç»™åƒæ‰äº†ï¼å®ƒæˆäº†reçš„å‚æ•°ï¼Œå¹¶ä¸”ç”±äºæ‹¬å·çš„å­˜åœ¨ï¼Œäº‹å®ä¸Šæ˜¯ä¸ªè¯­æ³•é”™è¯¯ï¼
æ€ä¹ˆæ ·æ‰èƒ½è®©reâ€œåƒäº†æˆ‘çš„ç»™æˆ‘åå‡ºæ¥â€å‘¢ï¼Ÿå‰é¢è¯´äº†ï¼Œï¼ˆ-p \;ï¼‰ä¼šåœ¨åŒ¹é…çš„å†å²
å‘½ä»¤ä¹‹å‰å…ˆæ‰“ä¸ªåˆ†å·å‡ºæ¥ï¼Œæ‰€ä»¥ä½ çœ‹åˆ°çš„æ˜¯ï¼š

: re mm uboot ;(cd $(lookup-file vendor/marvell/generic/tcmd/kernel-helper); time mm -j8 -k uboot) 

åˆ†å·å’Œæ¢è¡Œç¬¦æ˜¯Bashé‡Œçš„è¯­å¥åˆ†éš”ç¬¦ï¼ŒåŠ äº†è¿™ä¸ªåˆ†å·ä¹‹å =re mm uboot ;= æˆä¸º
ä¸€æ¡ç‹¬ç«‹çš„è¯­å¥ä»€ä¹ˆä¹Ÿä¸å¹²çš„éšé£å»äº†ï¼Œå‰©ä¸‹æˆ‘ä»¬çœŸæ­£æƒ³è¦çš„å¥½å¹²æ´»å•Šã€‚

å¦‚æœä¸åŠ .0çš„è¯æˆ‘ä»¬æŒ‰Tabé”®æ˜¯ä»€ä¹ˆæ•ˆæœå‘¢ï¼Ÿè¿™æ—¶å€™ä¸€èˆ¬ä¼šæœ‰å¤šä¸ªåŒ¹é…é¡¹ï¼ŒBashä¼š
æŠŠå®ƒä»¬éƒ½åˆ—å‡ºæ¥ã€‚å¦‚æœæ˜¯Bashè‡ªå¸¦çš„è¡¥é½æœºåˆ¶ï¼Œå®ƒä¼šè¦æ±‚ä½ ç»§ç»­è¾“å…¥èƒ½ç»§ç»­åŒ¹é…
çš„å­ä¸²ã€‚ä»¥apt-get install latexçš„è¡¥é½ä¸ºä¾‹ï¼ŒBashä¼šæç¤ºæœ‰è¿™ä¹ˆäº›é€‰é¡¹ï¼š

#+BEGIN_EXAMPLE
latex209-base                      latex-cjk-chinese                  latex-cjk-korean                   latexila-data
latex209-bin                       latex-cjk-chinese-arphic-bkai00mp  latex-cjk-thai                     latex-make
latex209-src                       latex-cjk-chinese-arphic-bsmi00lp  latex-cjk-xcjk                     latexmk
latex2html                         latex-cjk-chinese-arphic-gbsn00lp  latexdiff                          latex-mk
latex2rtf                          latex-cjk-chinese-arphic-gkai00mp  latexdraw                          latexml
latex2rtf-doc                      latex-cjk-common                   latex-fonts-sipa-arundina          latex-sanskrit
latex-beamer                       latex-cjk-japanese                 latex-fonts-thai-tlwg              latex-xcolor
latex-cjk-all                      latex-cjk-japanese-wadalab         latexila                           
#+END_EXAMPLE

æ‰€ä»¥ä½ è¦ç»§ç»­è¾“å…¥-cjkï¼ˆå‡è®¾ä½ æƒ³è¦è£…çš„æ˜¯
latex-cjk-chinese-arphic-gkai00mp ï¼‰ï¼Œç„¶åå†æŒ‰ä¸€ä¸‹Tabé”®ï¼ŒBashä¼šæç¤ºä½ è¿˜
æœ‰è¿™ä¹ˆäº›é€‰é¡¹ï¼ˆå®ƒå€’æ˜¯ä¼šè‡ªåŠ¨å¸®ä½ æ·»ä¸ªå‡å·æŠŠ-cjkè¡¥æˆ-cjk-ï¼‰ï¼š

#+BEGIN_EXAMPLE
$apt-get install latex-cjk- # è¿™é‡Œè¿æŒ‰ä¸¤æ¬¡Tabé”®
latex-cjk-all                      latex-cjk-chinese-arphic-bsmi00lp  latex-cjk-common                   latex-cjk-korean
latex-cjk-chinese                  latex-cjk-chinese-arphic-gbsn00lp  latex-cjk-japanese                 latex-cjk-thai
latex-cjk-chinese-arphic-bkai00mp  latex-cjk-chinese-arphic-gkai00mp  latex-cjk-japanese-wadalab         latex-cjk-xcjk
#+END_EXAMPLE

ç„¶åä½ è¾“å…¥chï¼Œbashä¼šè‡ªåŠ¨å¸®ä½ è¡¥æˆchineseï¼Œä½†æ¥ä¸‹æ¥åˆæç¤ºä½ ï¼š

#+BEGIN_EXAMPLE
$apt-get install latex-cjk-chinese
latex-cjk-chinese                  latex-cjk-chinese-arphic-bsmi00lp  latex-cjk-chinese-arphic-gkai00mp  
latex-cjk-chinese-arphic-bkai00mp  latex-cjk-chinese-arphic-gbsn00lp  
#+END_EXAMPLE

ç„¶åä½ è¾“å…¥-aï¼Œbashä¼šè‡ªåŠ¨å¸®ä½ è¡¥æˆ-arphic-ï¼Œä½†æ¥ä¸‹æ¥åˆæç¤ºä½ ï¼š

#+BEGIN_EXAMPLE
$apt-get install latex-cjk-chinese-arphic-
latex-cjk-chinese-arphic-bkai00mp  latex-cjk-chinese-arphic-bsmi00lp  latex-cjk-chinese-arphic-gbsn00lp  latex-cjk-chinese-arphic-gkai00mp
#+END_EXAMPLE

å¥½äº†ï¼Œæˆ‘æƒ³ä½ è‚¯å®šæ˜ç™½æˆ‘çš„æ„æ€äº†ã€‚

æŒ‰ç…§æˆ‘çš„è¡¥é½æ–¹æ³•ï¼Œapt-get install latexä¹‹åæŒ‰ä¸¤ä¸‹Tabé”®ï¼Œåº”è¯¥å‡ºç°è¿™æ ·çš„æç¤ºï¼š

#+BEGIN_EXAMPLE
$apt-get install latex
00: latex209-base                               11: latex-cjk-chinese-arphic-gbsn00lp
01: latex209-bin                                12: latex-cjk-chinese-arphic-gkai00mp
02: latex209-src                                13: latex-cjk-common
03: latex2html                                  14: latex-cjk-japanese
04: latex2rtf                                   15: latex-cjk-japanese-wadalab
05: latex2rtf-doc                               16: latex-cjk-korean
06: latex-beamer                                17: latex-cjk-thai
07: latex-cjk-all                               18: latex-cjk-xcjk
08: latex-cjk-chinese                           19: latexdiff
09: latex-cjk-chinese-arphic-bkai00mp           31 total zzz... please use hil (history list)!
10: latex-cjk-chinese-arphic-bsmi00lp           

#+END_EXAMPLE

ç„¶åæˆ‘åŠ ä¸ª.12å†æŒ‰ä¸ªTabå°±å¾—åˆ°æˆ‘æƒ³è¦çš„å•¦å¼å¼å¼ï¼

ï¼ˆåˆšåˆšä¸ºè¿™ä¸ªDemoå†™äº†ä¸€ä¸ªä¸´æ—¶çš„è¡¥é½é…ç½®ï¼š

#+BEGIN_SRC sh
function _apt_get()
{
    local cur prev
    local IFS=$'\n'

    COMPREPLY=()
    shift
    

    COMPREPLY=( $(skeleton_compgen_word.pl \
	 "latex209-base latex209-bin latex209-src latex2html latex2rtf latex2rtf-doc latex-beamer latex-cjk-all latex-cjk-chinese latex-cjk-chinese-arphic-bkai00mp latex-cjk-chinese-arphic-bsmi00lp latex-cjk-chinese-arphic-gbsn00lp latex-cjk-chinese-arphic-gkai00mp latex-cjk-common latex-cjk-japanese latex-cjk-japanese-wadalab latex-cjk-korean latex-cjk-thai latex-cjk-xcjk latexdiff latexdraw latex-fonts-sipa-arundina latex-fonts-thai-tlwg latexila latexila-data latex-make latexmk latex-mk latexml latex-sanskrit latex-xcolor" \
        -- "${COMP_WORDS[$COMP_CWORD]}")
    )
    return 0
}

complete -o default -F _apt_get apt-get
#+END_SRC
ï¼‰

æ‰€æœ‰çš„è„šæœ¬éƒ½å¯ä»¥åœ¨ [[http://github.com/baohaojun/system-config][system-config]] ä¸­æ‰¾åˆ°ï¼Œè§[[../../../2012/10/22/my-config-cn.org][æˆ‘çš„ç³»ç»Ÿé…ç½®]]ã€‚

[fn:skeleton] Emacsä¸‹æˆ‘å†™çš„ç±»ä¼¼çš„è¡¥é½æ–¹å¼è§[[../../../2012/12/27/stem-completion.org][skeleton-completeï¼ˆä¸­æ–‡ï¼‰]]å’Œ
[[../../04/13/skeleton-complete.org][skeleton-completeï¼ˆè‹±æ–‡ï¼‰]]ã€‚
