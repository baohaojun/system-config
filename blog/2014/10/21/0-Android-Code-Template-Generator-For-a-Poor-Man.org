#+title: ç©·æ±‰çš„å®‰å“ä»£ç æ¨¡æ¿ç”Ÿæˆå·¥å…·
# bhj-tags: tool
æˆ‘åˆšåˆšåˆçœ‹äº†ä¸€é [[https://developer.android.com/tools/projects/templates.html][å®‰å“SDKç›¸å…³çš„é¡µé¢]] ï¼Œå“æˆ‘ä¸€è·³ï¼Œçœ‹åˆ°äº†ä¸€ä¸ª â€œ[[https://developer.android.com/tools/projects/templates.html][From the
Command Line]]â€ è¿™æ ·çš„å­—çœ¼ï¼Œè¿˜ä»¥ä¸ºå®‰å“SDKä¹Ÿæ”¯æŒè¿™æ ·çš„å‘½ä»¤è¡Œå·¥å…·äº†ï¼Œé‚£æˆ‘
çš„è¡Œä¸ºè‰ºæœ¯å°±æ²¡æœ‰ä»·å€¼äº†ğŸ˜‚ã€‚å¹¸å¥½ï¼Œè™šæƒŠä¸€åœºï¼Œé‚£ä¸ªé“¾æ¥æŒ‡å‘çš„æ˜¯å¦‚ä½•ç”¨å‘½ä»¤
è¡Œç”Ÿæˆä¸€ä¸ªå®‰å“é¡¹ç›®ï¼Œä½†å¹¶ä¸èƒ½ç”Ÿæˆä»£ç ã€‚æƒ³ç”Ÿæˆä»£ç ï¼Œè¿˜æ˜¯åªèƒ½ç”¨Eclipseæˆ–
è€…Android Studioã€‚

æˆ‘åœ¨å¤§åŠå¹´ä¹‹å‰å°±å·²ç»å†™å‡ºäº†è¿™ä¸ªåœ¨å‘½ä»¤è¡Œä¸Šç”ŸæˆAndroidä»£ç çš„è„šæœ¬ã€‚åŸºæœ¬ä¸Š
åªè¦æ˜¯Eclipseæ”¯æŒçš„æ¯ä¸ªæ¨¡æ¿ï¼Œæˆ‘çš„è„šæœ¬ä¹Ÿå…¨éƒ¨æ”¯æŒï¼Œæ¯”å¦‚projectã€activityã€
serviceç­‰ç­‰ã€‚åªè¦æ˜¯Eclipseæ”¯æŒçš„å¯é€‰å‚æ•°ï¼ˆæ¯”å¦‚packageçš„åå­—ã€activity
çš„åå­—ï¼Œnavigatorçš„ç±»å‹ï¼‰ï¼Œæˆ‘çš„è„šæœ¬ä¹Ÿå…¨éƒ¨æ”¯æŒã€‚å› ä¸ºæˆ‘å®Œå…¨æ˜¯æŠ ç€Eclipse
é‡Œé¢çš„ä»£ç é‡å†™çš„ï¼ŒåŒ…æ‹¬å®ƒä½¿ç”¨çš„freemarkerè¿™ä¸ªjavaåŒ…ã€‚

é‡Œé¢ç”¨åˆ°çš„æ¨¡æ¿ä¹ŸåŸºæœ¬ä¸Šå¤ç”¨äº†Android SDKæä¾›çš„é‚£ä¸€å¥—æ¨¡æ¿ï¼Œåªæ˜¯ä¿®æ”¹äº†ä¸€
äº›æ˜æ˜¾çš„bugå’Œä¸€äº›åœ¨å‘½ä»¤è¡Œä¸Šé‡åšæ—¶ä¸åˆ‡å®é™…çš„ä»£ç ã€‚

ä»¥BlankActivityä¸ºä¾‹ï¼Œåœ¨æˆ‘çš„system-configé‡Œï¼Œå®ƒçš„è·¯å¾„åœ¨ [[https://github.com/baohaojun/system-config/tree/master/gcode/android-templates/activities/BlankActivity][è¿™é‡Œ]] ï¼Œä½†äº‹å®ä¸Š
ä½ å¯ä»¥å¯¹æ¯”ä¸€ä¸‹ï¼Œæˆ‘æ˜¯ä»
=android-sdk-linux/tools/templates/activities/BlankActivity= é‡Œæ‹·è´å‡º
æ¥çš„ï¼Œç„¶ååªåšè¿‡ä¸€ä¸ªæ”¹åŠ¨ã€‚

å®‰å“SDKçš„è¿™å¥—ä»£ç æ¨¡æ¿åŸºæœ¬ä¸Šéƒ½æ˜¯è¿™æ ·ç»„ç»‡çš„ï¼š

1. æœ‰ä¸€ä¸ª [[https://github.com/baohaojun/system-config/raw/master/gcode/android-templates/activities/BlankActivity/template.xml][template.xml]] ã€‚é‡Œé¢æˆ‘ä¸»è¦ç”¨åˆ°äº†å®ƒç»™å‡ºçš„å„ä¸ªå‚æ•°ï¼Œæ¯”å¦‚package
   åå­—ï¼Œlayoutçš„åå­—ï¼ŒActivityçš„åå­—ï¼Œæ˜¯ä¸æ˜¯Launcher Activityï¼ˆæ¡Œé¢ä¸Š
   æœ‰å›¾æ ‡çš„Activityï¼‰ã€‚ç­‰ç­‰ã€‚

   å¦‚æœæ˜¯åœ¨Eclipseé‡Œçš„è¯ï¼Œè¿™ä¸ªæ–‡ä»¶è¿˜æä¾›äº†å„ç§ç¼©ç•¥å›¾ï¼Œæ¯”å¦‚ä½ é€‰äº†ä¸€ä¸ª
   layoutä¹‹åï¼ŒEclipseå°±ä¼šæ˜¾ç¤ºä¸€ä¸ªæ­¤layoutçš„ç¤ºæ„å›¾ç»™ä½ çœ‹ã€‚ä½†è¿™ä¸ªå¯¹æˆ‘ä»¬
   è¿™æ ·çš„ç©·æ±‰æ¥è¯´ï¼Œæœ‰ç‚¹å¤ªå¥¢ä¾ˆäº†ï¼Œæ‰€ä»¥åªè¦è‡ªå·±è„‘æ´å¤§å¼€ï¼Œè„‘è¡¥ä¸€ä¸‹è¿™ä¸ªç¤º
   æ„å›¾å°±å¥½äº†ğŸ˜‚

2. æœ‰ä¸€ä¸ª [[https://github.com/baohaojun/system-config/raw/master/gcode/android-templates/activities/BlankActivity/globals.xml.ftl][globals.xml.ftl]] ã€‚æ‰€æœ‰ä»¥.ftlä¸ºæ‰©å±•åçš„æ–‡ä»¶ï¼Œéƒ½æ˜¯freemarker
   templateçš„æ„æ€ï¼Œéœ€è¦äº¤ç»™freemarkerç¨‹åºå¤„ç†ä¸€ä¸‹æ‰å¯ä»¥ã€‚è¿™ä¸ªæ–‡ä»¶é‡Œçš„
   å†…å®¹å°±æ˜¯ä¸€äº›å˜é‡çš„é»˜è®¤å€¼ã€‚

3. æœ‰ä¸€ä¸ª [[https://github.com/baohaojun/system-config/raw/master/gcode/android-templates/activities/BlankActivity/recipe.xml.ftl][recipe.xml.ftl]] æ–‡ä»¶ã€‚è¿™ä¸ªæ–‡ä»¶é¡¾åæ€ä¹‰ï¼Œå°±æ˜¯èœè°±çš„æ„æ€ï¼Œå‘Šè¯‰
   freemarkeråº”è¯¥æ€ä¹ˆä¸€æ­¥ä¸€æ­¥åœ°æŠŠæ‰€æœ‰ä»£ç æ–‡ä»¶ä»æ¨¡æ¿ä¸­ç”Ÿæˆå‡ºæ¥ï¼ˆå…¶å®å°±
   æ˜¯å˜é‡æ›¿æ¢è€Œå·²ï¼Œæ¯”å¦‚æŠŠ [[https://github.com/baohaojun/system-config/raw/master/gcode/android-templates/activities/BlankActivity/root/AndroidManifest.xml.ftl][root/AndroidManifest.xml.ftl]] æ–‡ä»¶é‡Œçš„è¿™æ ·ä¸€
   è¡Œï¼š

   #+BEGIN_EXAMPLE
   android:label="@string/title_${activityToLayout(activityClass)}"
   #+END_EXAMPLE

   é‡Œé¢çš„activityClassé€šè¿‡ä¸€ä¸ªfreemarkerçš„activityToLayoutåº“å‡½æ•°ï¼ˆç”±æˆ‘
   æä¾›ï¼‰æ”¹å†™æˆå¦ä¸€ä¸ªæ ‡è¯†ç¬¦ã€‚

4. ä¸€å †çš„æ¨¡æ¿æ–‡ä»¶ï¼ŒåŸºæœ¬ä¸Šå…¨ä»¥.ftlä¸ºæ‰©å±•åã€‚æ¯”å¦‚BlankActivityæœ‰è¿™ä¹ˆäº›ï¼š

   #+BEGIN_EXAMPLE
    ./root/src/app_package/TabsActivity.java.ftl
    ./root/src/app_package/DropdownActivity.java.ftl
    ./root/src/app_package/include_onCreateOptionsMenu.java.ftl
    ./root/src/app_package/TabsAndPagerActivity.java.ftl
    ./root/src/app_package/include_DummySectionFragment.java.ftl
    ./root/src/app_package/SimpleActivity.java.ftl
    ./root/src/app_package/include_onOptionsItemSelected.java.ftl
    ./root/res/menu/main.xml.ftl
    ./root/res/values/strings.xml.ftl
    ./root/res/layout/fragment_dummy.xml.ftl
    ./root/res/layout/activity_pager.xml.ftl
    ./root/res/layout/activity_simple.xml.ftl
    ./root/AndroidManifest.xml.ftl
    ./recipe.xml.ftl
    ./globals.xml.ftl
   #+END_EXAMPLE

å…¶ä¸­è¦æ³¨æ„çš„æ˜¯ï¼Œfreemarkeré™¤äº†ç®€å•çš„å˜é‡æ›¿æ¢åŠŸèƒ½ï¼Œè¿˜æœ‰å¤æ‚çš„if/elseé€»
è¾‘ï¼Œåº”æ­¤å¯ä»¥å®ç°ä¸€äº›æ¯”å¦‚æ ¹æ®æ‰€é€‰çš„Activity NavTypeçš„ä¸åŒè€Œç”Ÿæˆä¸åŒçš„ä»£
ç ã€‚

æˆ‘çš„freemarkerè„šæœ¬åªæ˜¯å¯¹Debianè‡ªå¸¦çš„libfreemarker-javaåŒ…çš„ä¸€ä¸ªå°è£…ï¼Œè„š
æœ¬åœ¨ [[https://github.com/baohaojun/system-config/raw/master/bin/freemarker][è¿™é‡Œ]] ã€‚Javaä»£ç åœ¨ [[https://github.com/baohaojun/system-config/tree/master/bin/FreeMarker.d][è¿™é‡Œ]] ã€‚è¿™ä¸ªè„šæœ¬å¦‚æœå‘ç°éœ€è¦é‡æ–°ç¼–è¯‘ä¸€ä¸‹çš„è¯ä¼šè‡ª
åŠ¨å¤„ç†ï¼Œæ‰€ä»¥æˆ‘ä¿®æ”¹å®ŒJavaä»£ç ä¹‹åä¸éœ€è¦æ‰‹åŠ¨æ›´æ–°.classæ–‡ä»¶ï¼ŒçœŸæ˜¯äººç”Ÿä½•å¤„
ä¸è‡ªåŠ¨åŒ–å“ˆğŸ˜Šã€‚

æ€»é©±åŠ¨è„šæœ¬ï¼Œpoormans-android-templateï¼Œåœ¨ [[https://github.com/baohaojun/system-config/raw/master/bin/poormans-android-template][è¿™é‡Œ]] ã€‚

ç”¨æ³•æ˜¯ï¼š

#+BEGIN_SRC sh
poormans-android-template -t 'appli'
poormans-android-template -t 'blank activity' --isLauncher true --activityClass TheRightApkActivity
#+END_SRC

å…¶ä¸­ç¬¬ä¸€å¥æ˜¯ç”Ÿæˆä¸€ä¸ªapplicationï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªprojectäº†ï¼›ç¬¬äºŒå¥åˆ™æ˜¯ç”Ÿæˆä¸€
ä¸ªç©ºç™½çš„Activityã€‚ä½ å¯ä»¥çœ‹åˆ°æˆ‘ä¸éœ€è¦æ‰“å®Œæ ¼çš„ -t å‚æ•°ï¼Œåé¢åªè·Ÿäº†ä¸€ä¸ª
â€œappliâ€ï¼Œè„šæœ¬å°±ä¼šè‡ªåŠ¨åŒ¹é…å‡ºæœ€åˆé€‚çš„templateç»™æˆ‘ï¼Œå¦‚æœæœ‰å¤šä¸ªçš„è¯è¿˜ä¼šè®©
æˆ‘é€‰ï¼Œè¿™ä¸ªç‰¹æ€§ä½ åœ¨Firefoxçš„åœ°å€æ é‡Œä¹Ÿå¯ä»¥çœ‹åˆ°ã€‚æ›´å…·ä½“çš„ç”¨æ³•è§è„šæœ¬ï¼Œæ˜¯
ç”¨rubyå†™çš„ï¼Œå…¶å®æˆ‘ä¸ä¼šrubyğŸ˜„ã€‚

å…³äºè¿™ä¸ªåå­—ä¸ºä»€ä¹ˆè¿™ä¹ˆå€’éœ‰ï¼Œpoor manï¼Œå…¶å®ä¸æ˜¯ç©·æ±‰çš„æ„æ€ï¼Œè€Œæ˜¯å› ä¸ºè¿™ä¸ª
è„šæœ¬å†™å¾—æœ‰ç‚¹ç²—ç³™ï¼Œç”Ÿæˆå®Œapplicationå†ç”Ÿæˆactivityä¹‹åéœ€è¦æ‰‹åŠ¨æ”¹ä¸€ä¸‹
AndroidManifest.xmlæ–‡ä»¶ï¼Œå¦åˆ™ä¸æ˜¯ä¸€ä¸ªåˆæ³•çš„.xmlğŸ˜„ã€‚è°ç”¨è°çŸ¥é“ğŸ˜‚ã€‚

ä»¥ä¸Šå·¥ä½œå®Œæˆäºåœ¨é˜¿é‡Œå·´å·´å·¥ä½œæœŸé—´ï¼Œæ„Ÿè°¢ã€‚
